{"ast":null,"code":"import _asyncToGenerator from\"/home/sree/Documents/Works/naadanvipani/frontend/naadan-vipani-trivandrum-for-backend-master/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/home/sree/Documents/Works/naadanvipani/frontend/naadan-vipani-trivandrum-for-backend-master/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/home/sree/Documents/Works/naadanvipani/frontend/naadan-vipani-trivandrum-for-backend-master/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/sree/Documents/Works/naadanvipani/frontend/naadan-vipani-trivandrum-for-backend-master/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/sree/Documents/Works/naadanvipani/frontend/naadan-vipani-trivandrum-for-backend-master/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useContext}from'react';import Firebase from'./Firebase';// import { AppContext } from '../utils/AppContext';\n// import {  useContext } from 'react';\n// used to open routes\nimport{useHistory}from'react-router-dom';// used to open routes\nimport{authenticate_save_jwt,isAuthenticated,signOut}from'./AuthenticationHandler';import\"./loginpage1.css\";import Icon from\"./Images/icons-2.png\";import{ContextConsumer}from'../utils/Context';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function App(){// signOut();\nvar contextValues=useContext(ContextConsumer);// used to open routes\nvar history=useHistory();if(isAuthenticated){}else{console.log(\"not authenticated\");history.push('/');}// used to open routes\n// const ContextValue = useContext(AppContext);\n// console.log(ContextValue)\n//used to hold the main values in the file \nvar _useState=useState({otp:'',mobile:'',confirmationResult:'',c_error:'',redirectToReffer:false,district:\"\",block:\"\"}),_useState2=_slicedToArray(_useState,2),values=_useState2[0],setValues=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),showGetOtpButton=_useState4[0],SetshowGetOtpButton=_useState4[1];// handle change is called when there is a change in the input box\nvar handleChange=function handleChange(name){return function(event){// console.log(name ,\" : \",event.target.value);\nsetValues(_objectSpread(_objectSpread({},values),{},_defineProperty({},name,event.target.value)));if(name===\"district\"){contextValues.setblock(event.target.value);}if(name===\"block\"){contextValues.setdistrict(event.target.value);}// console.log( \"district: \", contextValues.district, \" block:\", contextValues.block );\n// contextValues.setUserValues({\n//   ...contextValues.userValues,\n//   user_address : [name , event.target.value], \n// })\n// contextValues.handleChangeBlockAndDistrict(\n//   { ...contextValues.values, [name]: event.target.contextValues.value }\n// )\n};};var getOtp=function getOtp(){// this function sends otp to the mobile number using firebase. \nvar phoneNumber=\"+91\"+values.mobile;console.log(\"otp section : \",phoneNumber);if(values.mobile===\"\"||values.mobile.length<10){// enter here if the entered phone number is null \n//  or the number is less than 10 digit\nSetshowGetOtpButton(true);// SetshowGetOtpButton(true); will set the get otp button button visibility to true \n// if it is true then the button is visible . \n// if the number is not entered this button will be visible \nconsole.log(\"enter valid phone number\");console.log(\"district : \",contextValues.district);console.log(\"block : \",contextValues.block);if(values.mobile===\"\"||values.mobile.length<10){console.log(\"please enter valid phone number\");}}else if(!isAuthenticated()&&contextValues.district===\"0\"){console.log(\"please select valid district\");}else if(!isAuthenticated()&&contextValues.block===\"0\"){console.log(\"please select valid block\");}else{console.log(\"got phone number\");// this section is executed if the user enter a valid phone number . \n// if it is a valid number first we disable the get otp button using below line \nSetshowGetOtpButton(false);// SetshowGetOtpButton(false); will disable the get otp button\nconsole.log(\"district : \",contextValues.district);console.log(\"block : \",contextValues.block);if(contextValues.district==\"0\"){console.log(\"please select valid district\");// return;\n}if(contextValues.block==\"0\"){console.log(\"please select valid block\");// return;\n}// Firebase otpsent section START\nvar recaptcha=new Firebase.auth.RecaptchaVerifier('recaptcha-container');Firebase.auth().signInWithPhoneNumber(phoneNumber,recaptcha).then(function(e){setValues(_objectSpread(_objectSpread({},values),{},{confirmationResult:e}));console.log(\"OTP is sent\");}).catch(function(error){console.log(error);alert(error);});// Firebase otp sent section END\n}};var RedirectToHome=function RedirectToHome(){// used to redirect to home screen \nhistory.push(\"/\");};var submitOTP=function submitOTP(e){// read the entered otp \nvar code=values.otp;console.log(\"otp : \",code);// console log the entered otp \n// confirm the otp\nvalues.confirmationResult.confirm(code).then(function(result){console.log(result.user,\"User\");// if the otp is correct it enters here \nauthenticate_save_jwt({phoneNumber:\"+91\"+values.mobile});}).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// await contextValues.initUserAddress()\nconsole.log(\"data is : \");RedirectToHome();case 2:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(err){// if otp is wrong it enter here\nconsole.log(\"error\");alert(\"error or wrong otp\");});};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(\"div\",{children:// if confirmationResult equal to zero \n// then the enter phone number screen is displayed\nvalues.confirmationResult.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"login_main row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"login_container d-flex col-md-6 justify-content-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login_small_container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"icon_container\",children:/*#__PURE__*/_jsx(\"img\",{src:Icon,alt:\"\",className:\"login_icon\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"login_text_container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"We will send you a \",/*#__PURE__*/_jsx(\"strong\",{children:\"One Time Password \"}),\"on your phone number.\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mobile_number_container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"mobile\",placeholder:\"Mobile Number\",onChange:handleChange('mobile'),value:values.mobile,required:true}),!isAuthenticated()?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"select\",{type:\"text\",name:\"district\",placeholder:\"district\",onChange:handleChange('district'),value:values.district,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"0\",children:\"select\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"Trivandrum\"})]}),values.district===\"1\"?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"select\",{type:\"text\",name:\"block\",placeholder:\"block\",onChange:handleChange('block'),value:values.block,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"0\",children:\"select\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"Paalayam\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"Poojappura\"})]})}):values.district===\"2\"?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"select\",{type:\"text\",name:\"block\",placeholder:\"block\",onChange:handleChange('block'),value:values.block,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"0\",children:\"select\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"Kochi\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"kaakkanadu\"})]})}):values.district===\"3\"?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"select\",{type:\"text\",name:\"block\",placeholder:\"block\",onChange:handleChange('block'),value:values.block,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"0\",children:\"select\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"Alappuzha 1\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"Alappuzha 2\"})]})}):/*#__PURE__*/_jsx(_Fragment,{})]}):/*#__PURE__*/_jsx(_Fragment,{})]}),/*#__PURE__*/_jsx(\"div\",{className:\"button_container\",children:// if the phonenumber is not entered \n// the showGetOtpButton will be true\n// the get otp button is displayed \nshowGetOtpButton?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){getOtp();},children:\"GET OTP\"})}):/*#__PURE__*/_jsx(_Fragment,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"recaptcha_container\",children:/*#__PURE__*/_jsx(\"div\",{id:\"recaptcha-container\",className:\"recaptcha\"})})]})})})}),/*#__PURE__*/_jsx(\"div\",{children:// if confirmationResult not equal to zero then the otp is sent\n// then the enter otp section is displayed    \nvalues.confirmationResult.length!==0&&/*#__PURE__*/_jsx(\"div\",{className:\"login_main row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"login_container d-flex justify-content-center col-md-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login_small_container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"icon_container\",children:/*#__PURE__*/_jsx(\"img\",{src:Icon,alt:\"\",className:\"login_icon\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"login_text_container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"You will get a \",/*#__PURE__*/_jsx(\"strong\",{children:\"OTP \"}),\"via \",/*#__PURE__*/_jsx(\"strong\",{children:\"SMS\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mobile_number_container\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"otp\",type:\"text\",name:\"otp\",placeholder:\"OTP\",onChange:handleChange('otp'),value:values.otp,required:true}),/*#__PURE__*/_jsx(\"span\",{class:\"focus-input100\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"recaptcha_container\",children:/*#__PURE__*/_jsx(\"div\",{id:\"recaptcha-container\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"button_container\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){submitOTP();},children:\"SUBMIT\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"retry_container\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Message is not receive ?\\xA0\\xA0\\xA0\"}),/*#__PURE__*/_jsx(\"a\",{href:\"/\",onClick:function onClick(){// executed when retry button is pressed\n// if pressed confirmationResult and otp is set to null\nsetValues(_objectSpread(_objectSpread({},values),{},{confirmationResult:'',otp:''}));// then we set SetshowGetOtpButton(true) \n// so that the enter phone number page is displayed\nSetshowGetOtpButton(true);RedirectToHome();},children:\"Retry again\"})]})]})})})})]});}export default App;","map":{"version":3,"sources":["/home/sree/Documents/Works/naadanvipani/frontend/naadan-vipani-trivandrum-for-backend-master/src/Auth/Login.js"],"names":["React","useState","useContext","Firebase","useHistory","authenticate_save_jwt","isAuthenticated","signOut","Icon","ContextConsumer","App","contextValues","history","console","log","push","otp","mobile","confirmationResult","c_error","redirectToReffer","district","block","values","setValues","showGetOtpButton","SetshowGetOtpButton","handleChange","name","event","target","value","setblock","setdistrict","getOtp","phoneNumber","length","recaptcha","auth","RecaptchaVerifier","signInWithPhoneNumber","then","e","catch","error","alert","RedirectToHome","submitOTP","code","confirm","result","user","data","err"],"mappings":"83BAAA,MAAOA,CAAAA,KAAP,EAAiBC,QAAjB,CAA2BC,UAA3B,KAA6C,OAA7C,CAEA,MAAOC,CAAAA,QAAP,KAAqB,YAArB,CACA;AACA;AAEA;AACA,OAASC,UAAT,KAA2B,kBAA3B,CACA;AAIA,OAASC,qBAAT,CAAgCC,eAAhC,CAAiDC,OAAjD,KAAgE,yBAAhE,CACA,MAAO,kBAAP,CACA,MAAOC,CAAAA,IAAP,KAAiB,sBAAjB,CAEA,OAAQC,eAAR,KAA8B,kBAA9B,C,6IAGA,QAASC,CAAAA,GAAT,EAAe,CAEb;AAEA,GAAMC,CAAAA,aAAa,CAAGT,UAAU,CAACO,eAAD,CAAhC,CAEA;AACA,GAAIG,CAAAA,OAAO,CAAGR,UAAU,EAAxB,CACA,GAAGE,eAAH,CAAmB,CAElB,CAFD,IAGI,CACFO,OAAO,CAACC,GAAR,CAAY,mBAAZ,EACAF,OAAO,CAACG,IAAR,CAAa,GAAb,EACD,CACD;AAGA;AACA;AAEA;AACA,cAA4Bd,QAAQ,CAAC,CACnCe,GAAG,CAAE,EAD8B,CAEnCC,MAAM,CAAE,EAF2B,CAGnCC,kBAAkB,CAAE,EAHe,CAInCC,OAAO,CAAC,EAJ2B,CAKnCC,gBAAgB,CAAC,KALkB,CAMnCC,QAAQ,CAAC,EAN0B,CAOnCC,KAAK,CAAC,EAP6B,CAAD,CAApC,wCAAOC,MAAP,eAAeC,SAAf,eAUA,eAAmDvB,QAAQ,CAAC,IAAD,CAA3D,yCAAQwB,gBAAR,eAA2BC,mBAA3B,eAIA;AACA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAAAC,IAAI,QAAI,UAAAC,KAAK,CAAI,CACpC;AACAL,SAAS,gCAAMD,MAAN,wBAAeK,IAAf,CAAsBC,KAAK,CAACC,MAAN,CAAaC,KAAnC,GAAT,CAEA,GAAGH,IAAI,GAAG,UAAV,CAAqB,CACnBjB,aAAa,CAACqB,QAAd,CAAwBH,KAAK,CAACC,MAAN,CAAaC,KAArC,EACD,CACD,GAAGH,IAAI,GAAG,OAAV,CAAkB,CAChBjB,aAAa,CAACsB,WAAd,CAA0BJ,KAAK,CAACC,MAAN,CAAaC,KAAvC,EACD,CAED;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAGD,CAvBwB,EAAzB,CA0BA,GAAMG,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,CACnB;AAGA,GAAIC,CAAAA,WAAW,CAAG,MAAQZ,MAAM,CAACN,MAAjC,CACAJ,OAAO,CAACC,GAAR,CAAY,gBAAZ,CAA+BqB,WAA/B,EAIA,GAAKZ,MAAM,CAACN,MAAP,GAAgB,EAAjB,EAA0BM,MAAM,CAACN,MAAP,CAAcmB,MAAd,CAAqB,EAAnD,CACA,CACE;AACA;AACAV,mBAAmB,CAAC,IAAD,CAAnB,CACA;AACA;AACA;AACAb,OAAO,CAACC,GAAR,CAAY,0BAAZ,EAEAD,OAAO,CAACC,GAAR,CAAY,aAAZ,CAA2BH,aAAa,CAACU,QAAzC,EACAR,OAAO,CAACC,GAAR,CAAY,UAAZ,CAAwBH,aAAa,CAACW,KAAtC,EAEA,GAAIC,MAAM,CAACN,MAAP,GAAgB,EAAjB,EAAuBM,MAAM,CAACN,MAAP,CAAcmB,MAAd,CAAqB,EAA/C,CAAmD,CACjDvB,OAAO,CAACC,GAAR,CAAY,iCAAZ,EAED,CAGF,CAnBD,IAoBK,IAAI,CAACR,eAAe,EAAhB,EAAuBK,aAAa,CAACU,QAAd,GAAyB,GAApD,CAAyD,CAC5DR,OAAO,CAACC,GAAR,CAAY,8BAAZ,EACD,CAFI,IAGA,IAAG,CAACR,eAAe,EAAhB,EAAsBK,aAAa,CAACW,KAAd,GAAsB,GAA/C,CAAoD,CACvDT,OAAO,CAACC,GAAR,CAAY,2BAAZ,EACD,CAFI,IAIL,CAEED,OAAO,CAACC,GAAR,CAAY,kBAAZ,EACA;AACA;AACAY,mBAAmB,CAAC,KAAD,CAAnB,CACA;AAEAb,OAAO,CAACC,GAAR,CAAY,aAAZ,CAA2BH,aAAa,CAACU,QAAzC,EACAR,OAAO,CAACC,GAAR,CAAY,UAAZ,CAAwBH,aAAa,CAACW,KAAtC,EAGA,GAAIX,aAAa,CAACU,QAAd,EAAwB,GAA5B,CAAgC,CAC9BR,OAAO,CAACC,GAAR,CAAY,8BAAZ,EACA;AACD,CACD,GAAGH,aAAa,CAACW,KAAd,EAAqB,GAAxB,CAA4B,CAC1BT,OAAO,CAACC,GAAR,CAAY,2BAAZ,EACA;AACD,CAGD;AACA,GAAIuB,CAAAA,SAAS,CAAG,GAAIlC,CAAAA,QAAQ,CAACmC,IAAT,CAAcC,iBAAlB,CAAoC,qBAApC,CAAhB,CACApC,QAAQ,CAACmC,IAAT,GAAgBE,qBAAhB,CAAsCL,WAAtC,CAAmDE,SAAnD,EACCI,IADD,CACM,SAAUC,CAAV,CAAa,CAEflB,SAAS,gCAAMD,MAAN,MAAcL,kBAAkB,CAAEwB,CAAlC,GAAT,CACA7B,OAAO,CAACC,GAAR,CAAY,aAAZ,EAEH,CAND,EAOC6B,KAPD,CAOO,SAAUC,KAAV,CAAiB,CACpB/B,OAAO,CAACC,GAAR,CAAY8B,KAAZ,EACAC,KAAK,CAACD,KAAD,CAAL,CAEH,CAXD,EAYA;AACD,CAGF,CA5ED,CA+EA,GAAME,CAAAA,cAAc,CAAE,QAAhBA,CAAAA,cAAgB,EAAK,CACzB;AACElC,OAAO,CAACG,IAAR,CAAa,GAAb,EACH,CAHD,CAKA,GAAMgC,CAAAA,SAAS,CAAI,QAAbA,CAAAA,SAAa,CAACL,CAAD,CAAK,CAExB;AACE,GAAIM,CAAAA,IAAI,CAAGzB,MAAM,CAACP,GAAlB,CACAH,OAAO,CAACC,GAAR,CAAY,QAAZ,CAAuBkC,IAAvB,EACA;AAEA;AACAzB,MAAM,CAACL,kBAAP,CAA0B+B,OAA1B,CAAkCD,IAAlC,EAAwCP,IAAxC,CAA8C,SAACS,MAAD,CAAU,CACpDrC,OAAO,CAACC,GAAR,CAAYoC,MAAM,CAACC,IAAnB,CAAwB,MAAxB,EACA;AACA9C,qBAAqB,CAAC,CAClB8B,WAAW,CAAG,MAAQZ,MAAM,CAACN,MADX,CAAD,CAArB,CAGH,CAND,EAOCwB,IAPD,0FAOO,iBAAOW,IAAP,kHACD;AACAvC,OAAO,CAACC,GAAR,CAAY,YAAZ,EACAgC,cAAc,GAHb,sDAPP,gEAYCH,KAZD,CAYO,SAAAU,GAAG,CAAE,CACV;AACExC,OAAO,CAACC,GAAR,CAAY,OAAZ,EACA+B,KAAK,CAAC,oBAAD,CAAL,CACH,CAhBD,EAkBD,CA1BD,CA8BA,mBACE,aAAK,SAAS,CAAC,KAAf,wBAEE,qBAEI;AACA;AACAtB,MAAM,CAACL,kBAAP,CAA0BkB,MAA1B,GAAqC,CAArC,eACA,YAAK,SAAS,CAAC,gBAAf,uBACE,YAAK,SAAS,CAAC,wDAAf,uBAEE,aAAK,SAAS,CAAC,uBAAf,wBAEI,YAAK,SAAS,CAAC,gBAAf,uBACI,YAAK,GAAG,CAAE5B,IAAV,CAAgB,GAAG,CAAC,EAApB,CAAuB,SAAS,CAAC,YAAjC,EADJ,EAFJ,cAMI,aAAK,SAAS,CAAC,sBAAf,wBACI,6BADJ,cAII,wDACqB,8CADrB,2BAJJ,GANJ,cAeI,aAAK,SAAS,CAAC,yBAAf,wBACI,cAAO,IAAI,CAAC,MAAZ,CAAmB,IAAI,CAAC,QAAxB,CAAiC,WAAW,CAAC,eAA7C,CAA6D,QAAQ,CAAEmB,YAAY,CAAC,QAAD,CAAnF,CAA+F,KAAK,CAAEJ,MAAM,CAACN,MAA7G,CAAqH,QAAQ,KAA7H,EADJ,CAII,CAACX,eAAe,EAAhB,cACA,wCACE,gBAAQ,IAAI,CAAC,MAAb,CAAoB,IAAI,CAAC,UAAzB,CAAoC,WAAW,CAAC,UAAhD,CAA2D,QAAQ,CAAEqB,YAAY,CAAC,UAAD,CAAjF,CAA+F,KAAK,CAAEJ,MAAM,CAACF,QAA7G,CAAuH,QAAQ,KAA/H,wBACE,eAAQ,KAAK,CAAC,GAAd,oBADF,cAEE,eAAQ,KAAK,CAAC,GAAd,wBAFF,GADF,CAcIE,MAAM,CAACF,QAAP,GAAkB,GAAlB,cACA,sCACE,gBAAQ,IAAI,CAAC,MAAb,CAAoB,IAAI,CAAC,OAAzB,CAAiC,WAAW,CAAC,OAA7C,CAAqD,QAAQ,CAAEM,YAAY,CAAC,OAAD,CAA3E,CAAsF,KAAK,CAAEJ,MAAM,CAACD,KAApG,CAA2G,QAAQ,KAAnH,wBACE,eAAQ,KAAK,CAAC,GAAd,oBADF,cAEE,eAAQ,KAAK,CAAC,GAAd,sBAFF,cAGE,eAAQ,KAAK,CAAC,GAAd,wBAHF,GADF,EADA,CASAC,MAAM,CAACF,QAAP,GAAkB,GAAlB,cACA,sCACE,gBAAQ,IAAI,CAAC,MAAb,CAAoB,IAAI,CAAC,OAAzB,CAAiC,WAAW,CAAC,OAA7C,CAAqD,QAAQ,CAAEM,YAAY,CAAC,OAAD,CAA3E,CAAsF,KAAK,CAAEJ,MAAM,CAACD,KAApG,CAA2G,QAAQ,KAAnH,wBACE,eAAQ,KAAK,CAAC,GAAd,oBADF,cAEE,eAAQ,KAAK,CAAC,GAAd,mBAFF,cAGE,eAAQ,KAAK,CAAC,GAAd,wBAHF,GADF,EADA,CASAC,MAAM,CAACF,QAAP,GAAkB,GAAlB,cACA,sCACE,gBAAQ,IAAI,CAAC,MAAb,CAAoB,IAAI,CAAC,OAAzB,CAAiC,WAAW,CAAC,OAA7C,CAAqD,QAAQ,CAAEM,YAAY,CAAC,OAAD,CAA3E,CAAsF,KAAK,CAAEJ,MAAM,CAACD,KAApG,CAA2G,QAAQ,KAAnH,wBACE,eAAQ,KAAK,CAAC,GAAd,oBADF,cAEE,eAAQ,KAAK,CAAC,GAAd,yBAFF,cAGE,eAAQ,KAAK,CAAC,GAAd,yBAHF,GADF,EADA,cASA,kBAzCJ,GADA,cAiDA,kBArDJ,GAfJ,cA4EI,YAAK,SAAS,CAAC,kBAAf,UAEU;AACA;AACA;AACFG,gBAAgB,cACZ,sCACI,eAAQ,OAAO,CAAE,kBAAM,CAEnBS,MAAM,GACP,CAHH,qBADJ,EADY,cAQZ,kBAbZ,EA5EJ,cA8FI,YAAK,SAAS,CAAC,qBAAf,uBACE,YAAK,EAAE,CAAC,qBAAR,CAA8B,SAAS,CAAC,WAAxC,EADF,EA9FJ,GAFF,EADF,EALJ,EAFF,cA8HE,qBAEI;AACA;AACAX,MAAM,CAACL,kBAAP,CAA0BkB,MAA1B,GAAqC,CAArC,eACA,YAAK,SAAS,CAAC,gBAAf,uBACE,YAAK,SAAS,CAAC,wDAAf,uBACE,aAAK,SAAS,CAAC,uBAAf,wBAEA,YAAK,SAAS,CAAC,gBAAf,uBACI,YAAK,GAAG,CAAE5B,IAAV,CAAgB,GAAG,CAAC,EAApB,CAAuB,SAAS,CAAC,YAAjC,EADJ,EAFA,cAMA,aAAK,SAAS,CAAC,sBAAf,wBACQ,6BADR,cAIQ,oDACiB,gCADjB,qBAC0C,+BAD1C,GAJR,GANA,cAeA,aAAK,SAAS,CAAC,yBAAf,wBAEE,cAAO,EAAE,CAAC,KAAV,CAAgB,IAAI,CAAC,MAArB,CACO,IAAI,CAAC,KADZ,CACkB,WAAW,CAAC,KAD9B,CAEO,QAAQ,CAAEmB,YAAY,CAAC,KAAD,CAF7B,CAGO,KAAK,CAAEJ,MAAM,CAACP,GAHrB,CAG0B,QAAQ,KAHlC,EAFF,cAOE,aAAM,KAAK,CAAC,gBAAZ,EAPF,GAfA,cAyBA,YAAK,SAAS,CAAC,qBAAf,uBACE,YAAK,EAAE,CAAC,qBAAR,EADF,EAzBA,cA6BA,YAAK,SAAS,CAAC,kBAAf,uBACE,eAAQ,OAAO,CAAE,kBAAI,CAAC+B,SAAS,GAAI,CAAnC,oBADF,EA7BA,cAmCA,aAAK,SAAS,CAAC,iBAAf,wBACA,2DADA,cAEA,UAAG,IAAI,CAAC,GAAR,CAAY,OAAO,CAAE,kBAAM,CACf;AACA;AACAvB,SAAS,gCAAKD,MAAL,MAAaL,kBAAkB,CAAE,EAAjC,CAAsCF,GAAG,CAAE,EAA3C,GAAT,CACA;AACA;AACAU,mBAAmB,CAAC,IAAD,CAAnB,CACAoB,cAAc,GACf,CARX,yBAFA,GAnCA,GADF,EADF,EALJ,EA9HF,GADF,CA+MD,CAED,cAAepC,CAAAA,GAAf","sourcesContent":["import React, {  useState, useContext } from 'react'\n\nimport Firebase from './Firebase'\n// import { AppContext } from '../utils/AppContext';\n// import {  useContext } from 'react';\n\n// used to open routes\nimport { useHistory } from 'react-router-dom'\n// used to open routes\n\n\n\nimport { authenticate_save_jwt, isAuthenticated, signOut } from './AuthenticationHandler'\nimport \"./loginpage1.css\"\nimport Icon from \"./Images/icons-2.png\"\n\nimport {ContextConsumer} from '../utils/Context'\n\n\nfunction App() {\n\n  // signOut();\n\n  const contextValues = useContext(ContextConsumer);\n\n  // used to open routes\n  let history = useHistory()\n  if(isAuthenticated){\n    \n  }\n  else{\n    console.log(\"not authenticated\")\n    history.push('/')\n  }\n  // used to open routes\n\n\n  // const ContextValue = useContext(AppContext);\n  // console.log(ContextValue)\n\n  //used to hold the main values in the file \n  const [values, setValues] = useState({\n    otp: '',\n    mobile: '',\n    confirmationResult: '',\n    c_error:'',\n    redirectToReffer:false,\n    district:\"\",\n    block:\"\"\n  })\n\n  const [ showGetOtpButton , SetshowGetOtpButton ] = useState(true)\n  \n\n\n  // handle change is called when there is a change in the input box\n  const handleChange = name => event => {    \n    // console.log(name ,\" : \",event.target.value);\n    setValues({ ...values, [name]: event.target.value })\n    \n    if(name===\"district\"){\n      contextValues.setblock( event.target.value )\n    }\n    if(name===\"block\"){\n      contextValues.setdistrict(event.target.value)\n    }\n\n    // console.log( \"district: \", contextValues.district, \" block:\", contextValues.block );\n    \n    // contextValues.setUserValues({\n    //   ...contextValues.userValues,\n    //   user_address : [name , event.target.value], \n    // })\n\n    // contextValues.handleChangeBlockAndDistrict(\n    //   { ...contextValues.values, [name]: event.target.contextValues.value }\n    // )\n    \n  \n  }\n\n\n  const getOtp = () => {\n    // this function sends otp to the mobile number using firebase. \n\n    \n    let phoneNumber = \"+91\" + values.mobile\n    console.log(\"otp section : \" , phoneNumber );\n\n    \n\n    if( (values.mobile===\"\") || ( values.mobile.length<10 )  )\n    {\n      // enter here if the entered phone number is null \n      //  or the number is less than 10 digit\n      SetshowGetOtpButton(true);\n      // SetshowGetOtpButton(true); will set the get otp button button visibility to true \n      // if it is true then the button is visible . \n      // if the number is not entered this button will be visible \n      console.log(\"enter valid phone number\" );\n      \n      console.log(\"district : \", contextValues.district)\n      console.log(\"block : \", contextValues.block);\n\n      if((values.mobile===\"\")||(values.mobile.length<10)){\n        console.log(\"please enter valid phone number\")\n        \n      }\n      \n  \n    }\n    else if (!isAuthenticated() && (contextValues.district===\"0\")){   \n      console.log(\"please select valid district\")\n    }\n    else if(!isAuthenticated() &&(contextValues.block===\"0\")){\n      console.log(\"please select valid block\")\n    }\n    else\n    {\n      \n      console.log(\"got phone number\" );\n      // this section is executed if the user enter a valid phone number . \n      // if it is a valid number first we disable the get otp button using below line \n      SetshowGetOtpButton(false);\n      // SetshowGetOtpButton(false); will disable the get otp button\n      \n      console.log(\"district : \", contextValues.district)\n      console.log(\"block : \", contextValues.block);\n\n       \n      if (contextValues.district==\"0\"){\n        console.log(\"please select valid district\")\n        // return;\n      }\n      if(contextValues.block==\"0\"){\n        console.log(\"please select valid block\")\n        // return;\n      }\n      \n\n      // Firebase otpsent section START\n      let recaptcha = new Firebase.auth.RecaptchaVerifier('recaptcha-container')\n      Firebase.auth().signInWithPhoneNumber(phoneNumber, recaptcha)\n      .then(function (e) {\n          \n          setValues({ ...values, confirmationResult: e })\n          console.log(\"OTP is sent\");\n          \n      })\n      .catch(function (error) {\n          console.log(error);\n          alert(error)\n          \n      });\n      // Firebase otp sent section END\n    }\n    \n    \n  }\n\n\n  const RedirectToHome =() =>{\n    // used to redirect to home screen \n      history.push(\"/\")\n  }\n\n  const submitOTP =  (e)=>{\n    \n  // read the entered otp \n    let code = values.otp\n    console.log(\"otp : \" , code );\n    // console log the entered otp \n\n    // confirm the otp\n    values.confirmationResult.confirm(code).then( (result)=>{\n        console.log(result.user,\"User\")\n        // if the otp is correct it enters here \n        authenticate_save_jwt({\n            phoneNumber : \"+91\" + values.mobile\n        })\n    })\n    .then( async (data)=>{\n          // await contextValues.initUserAddress()\n          console.log(\"data is : \" )\n          RedirectToHome()\n      })\n    .catch(err=>{\n      // if otp is wrong it enter here\n        console.log(\"error\")\n        alert(\"error or wrong otp\")\n    })\n\n  }\n\n\n  \n  return (\n    <div className=\"App\">\n\n      <div>\n        {\n          // if confirmationResult equal to zero \n          // then the enter phone number screen is displayed\n          values.confirmationResult.length === 0 &&\n          <div className=\"login_main row\">\n            <div className=\"login_container d-flex col-md-6 justify-content-center\">\n\n              <div className=\"login_small_container\">\n\n                  <div className=\"icon_container\">\n                      <img src={Icon} alt=\"\" className=\"login_icon\" />\n                  </div>\n\n                  <div className=\"login_text_container\">  \n                      <h1>\n                        Login\n                      </h1>\n                      <p>\n                        We will send you a <strong>One Time Password </strong>on your phone number.\n                      </p>\n                  </div>\n\n                  <div className=\"mobile_number_container\">\n                      <input type=\"text\" name=\"mobile\" placeholder=\"Mobile Number\" onChange={handleChange('mobile')} value={values.mobile} required/> \n                      \n                      {\n                      !isAuthenticated()?\n                      <>\n                        <select type=\"text\" name=\"district\" placeholder=\"district\" onChange={handleChange('district')} value={values.district} required> \n                          <option value=\"0\">select</option>\n                          <option value=\"1\">Trivandrum</option>\n                          {/* <option value=\"2\">Eranakulam</option>\n                          <option value=\"3\">Alappuzha</option>\n                          <option value=\"4\">Kottayam</option>\n                          <option value=\"5\">Palakkad</option>\n                          <option value=\"6\">Trissur</option>\n                          <option value=\"7\">Kollam</option>\n                          <option value=\"8\">Kannur</option> */}\n                        </select>\n\n                        {\n                          values.district===\"1\"?\n                          <>\n                            <select type=\"text\" name=\"block\" placeholder=\"block\" onChange={handleChange('block')} value={values.block} required> \n                              <option value=\"0\">select</option>\n                              <option value=\"1\">Paalayam</option>\n                              <option value=\"2\">Poojappura</option>\n                            </select>\n                          </>\n                          :\n                          values.district===\"2\"?\n                          <>\n                            <select type=\"text\" name=\"block\" placeholder=\"block\" onChange={handleChange('block')} value={values.block} required> \n                              <option value=\"0\">select</option>\n                              <option value=\"1\">Kochi</option>\n                              <option value=\"2\">kaakkanadu</option>\n                            </select>\n                          </>\n                          :\n                          values.district===\"3\"?\n                          <>\n                            <select type=\"text\" name=\"block\" placeholder=\"block\" onChange={handleChange('block')} value={values.block} required> \n                              <option value=\"0\">select</option>\n                              <option value=\"1\">Alappuzha 1</option>\n                              <option value=\"2\">Alappuzha 2</option>\n                            </select>\n                          </>\n                          :\n                          <>\n                          \n                          </>\n\n                        }\n                      </>\n                      :\n                      <></>\n                      }\n                      {/* <input type=\"text\" name=\"district\" placeholder=\"district\" onChange={handleChange('district')} value={values.district} required/>  */}\n                  </div>\n\n\n                  {/* <div id=\"recaptcha-container\"></div> */}\n\n                  <div className=\"button_container\">\n                          {\n                            // if the phonenumber is not entered \n                            // the showGetOtpButton will be true\n                            // the get otp button is displayed \n                          showGetOtpButton ?\n                              <>\n                                  <button onClick={() => {\n                                    \n                                      getOtp()\n                                    }}>GET OTP</button>\n                              </>\n                              :\n                              <>\n                              </>\n                          }        \n                  </div>\n\n                  <div className=\"recaptcha_container\">\n                    <div id=\"recaptcha-container\" className=\"recaptcha\"></div>\n                  </div>\n\n                  {/* <div className=\"retry_container\">\n                    <p>Message is not receive ?&nbsp;&nbsp;&nbsp;</p>\n                    <a href=\"/\">\n                      Retry again\n                    </a>\n                  </div> */}\n\n\n              </div>\n            </div>\n          </div>\n      \n        }\n      </div>\n\n\n      {/* fffffffffffffffffffffffffffffff */}\n\n      <div>\n        {\n          // if confirmationResult not equal to zero then the otp is sent\n          // then the enter otp section is displayed    \n          values.confirmationResult.length !== 0 &&\n          <div className=\"login_main row\">\n            <div className=\"login_container d-flex justify-content-center col-md-6\">\n              <div className=\"login_small_container\">\n\n              <div className=\"icon_container\">\n                  <img src={Icon} alt=\"\" className=\"login_icon\" />\n              </div>\n          \n              <div className=\"login_text_container\">  \n                      <h1>\n                        Login\n                      </h1>\n                      <p>\n                        You will get a <strong>OTP </strong>via <strong>SMS</strong>\n                      </p>\n              </div>\n\n              <div className=\"mobile_number_container\">\n                \n                <input id=\"otp\" type=\"text\"\n                       name=\"otp\" placeholder=\"OTP\"\n                       onChange={handleChange('otp')}\n                       value={values.otp} required/>\n\n                <span class=\"focus-input100\"></span>\n              </div>\n\n              <div className=\"recaptcha_container\">\n                <div id=\"recaptcha-container\" ></div>\n              </div>\n\n              <div className=\"button_container\">\n                <button onClick={()=>{submitOTP() } } >\n                    SUBMIT\n                </button>\n              </div>\n              \n              <div className=\"retry_container\">\n              <p>Message is not receive ?&nbsp;&nbsp;&nbsp;</p>\n              <a href=\"/\" onClick={() => {\n                          // executed when retry button is pressed\n                          // if pressed confirmationResult and otp is set to null\n                          setValues({...values, confirmationResult: '' , otp: ''})\n                          // then we set SetshowGetOtpButton(true) \n                          // so that the enter phone number page is displayed\n                          SetshowGetOtpButton(true)\n                          RedirectToHome()\n                        }} >\n                    Retry again\n              </a>\n              </div>\n\n              </div>\n      </div>\n\n          </div>\n          \n        }\n      </div>\n      </div>\n\n      \n\n    \n \n  );\n  \n  \n\n\n\n\n\n\n  \n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}